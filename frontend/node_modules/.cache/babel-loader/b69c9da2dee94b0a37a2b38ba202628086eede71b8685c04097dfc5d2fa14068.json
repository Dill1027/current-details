{"ast":null,"code":"// Role-based permissions utility functions\n\n// Define role hierarchies and permissions\nconst PERMISSIONS = {\n  user: {\n    read: true,\n    create: false,\n    update: false,\n    delete: false,\n    manageUsers: false\n  },\n  admin: {\n    read: true,\n    create: true,\n    update: true,\n    delete: false,\n    manageUsers: false\n  },\n  super_admin: {\n    read: true,\n    create: true,\n    update: true,\n    delete: true,\n    manageUsers: true\n  }\n};\n\n/**\n * Check if a user role has specific permissions\n * @param {string} role - User role (user, admin, super_admin)\n * @param {string[]} requiredPermissions - Array of required permissions\n * @returns {boolean} - True if user has all required permissions\n */\nexport const hasPermissions = (role, requiredPermissions) => {\n  if (!role || !requiredPermissions) {\n    return false;\n  }\n  const rolePermissions = PERMISSIONS[role];\n  if (!rolePermissions) {\n    return false;\n  }\n  return requiredPermissions.every(permission => rolePermissions[permission]);\n};\n\n/**\n * Check if user can perform CRUD operations\n * @param {string} role - User role\n * @returns {boolean} - True if user can create, update, or delete\n */\nexport const canPerformCRUD = role => {\n  return hasPermissions(role, ['create', 'update', 'delete']);\n};\n\n/**\n * Check if user can manage other users\n * @param {string} role - User role\n * @returns {boolean} - True if user can manage users\n */\nexport const canManageUsers = role => {\n  return hasPermissions(role, ['manageUsers']);\n};\n\n/**\n * Check if user is read-only\n * @param {string} role - User role\n * @returns {boolean} - True if user can only read\n */\nexport const isReadOnly = role => {\n  return role === 'user';\n};\n\n/**\n * Get all permissions for a role\n * @param {string} role - User role\n * @returns {object} - Object with permission flags\n */\nexport const getRolePermissions = role => {\n  return PERMISSIONS[role] || PERMISSIONS.user;\n};\n\n/**\n * Check if user can access a specific route\n * @param {string} role - User role\n * @param {string} route - Route path\n * @returns {boolean} - True if user can access route\n */\nexport const canAccessRoute = (role, route) => {\n  const protectedRoutes = {\n    '/items/create': ['create'],\n    '/items/edit': ['update'],\n    '/users': ['manageUsers']\n  };\n\n  // Check if route requires specific permissions\n  for (const [routePattern, permissions] of Object.entries(protectedRoutes)) {\n    if (route.includes(routePattern)) {\n      return hasPermissions(role, permissions);\n    }\n  }\n\n  // Default routes accessible to all authenticated users\n  return true;\n};\n\n/**\n * Format role name for display\n * @param {string} role - User role\n * @returns {string} - Formatted role name\n */\nexport const formatRole = role => {\n  if (!role) return 'User';\n  return role.split('_').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');\n};\n\n/**\n * Get role badge class for styling\n * @param {string} role - User role\n * @returns {string} - CSS class name\n */\nexport const getRoleBadgeClass = role => {\n  switch (role) {\n    case 'super_admin':\n      return 'badge-danger';\n    case 'admin':\n      return 'badge-warning';\n    case 'user':\n      return 'badge-primary';\n    default:\n      return 'badge-secondary';\n  }\n};\n\n/**\n * Get available roles for role assignment\n * @param {string} currentUserRole - Current user's role\n * @returns {string[]} - Array of roles current user can assign\n */\nexport const getAssignableRoles = currentUserRole => {\n  switch (currentUserRole) {\n    case 'super_admin':\n      return ['user', 'admin', 'super_admin'];\n    case 'admin':\n      return ['user'];\n    // Admins can only demote to user\n    default:\n      return [];\n    // Regular users cannot assign roles\n  }\n};","map":{"version":3,"names":["PERMISSIONS","user","read","create","update","delete","manageUsers","admin","super_admin","hasPermissions","role","requiredPermissions","rolePermissions","every","permission","canPerformCRUD","canManageUsers","isReadOnly","getRolePermissions","canAccessRoute","route","protectedRoutes","routePattern","permissions","Object","entries","includes","formatRole","split","map","word","charAt","toUpperCase","slice","join","getRoleBadgeClass","getAssignableRoles","currentUserRole"],"sources":["/Users/prabhath/Desktop/CODVEDA internship/current-details/frontend/src/utils/permissions.js"],"sourcesContent":["// Role-based permissions utility functions\n\n// Define role hierarchies and permissions\nconst PERMISSIONS = {\n  user: {\n    read: true,\n    create: false,\n    update: false,\n    delete: false,\n    manageUsers: false,\n  },\n  admin: {\n    read: true,\n    create: true,\n    update: true,\n    delete: false,\n    manageUsers: false,\n  },\n  super_admin: {\n    read: true,\n    create: true,\n    update: true,\n    delete: true,\n    manageUsers: true,\n  },\n};\n\n/**\n * Check if a user role has specific permissions\n * @param {string} role - User role (user, admin, super_admin)\n * @param {string[]} requiredPermissions - Array of required permissions\n * @returns {boolean} - True if user has all required permissions\n */\nexport const hasPermissions = (role, requiredPermissions) => {\n  if (!role || !requiredPermissions) {\n    return false;\n  }\n\n  const rolePermissions = PERMISSIONS[role];\n  \n  if (!rolePermissions) {\n    return false;\n  }\n\n  return requiredPermissions.every(permission => rolePermissions[permission]);\n};\n\n/**\n * Check if user can perform CRUD operations\n * @param {string} role - User role\n * @returns {boolean} - True if user can create, update, or delete\n */\nexport const canPerformCRUD = (role) => {\n  return hasPermissions(role, ['create', 'update', 'delete']);\n};\n\n/**\n * Check if user can manage other users\n * @param {string} role - User role\n * @returns {boolean} - True if user can manage users\n */\nexport const canManageUsers = (role) => {\n  return hasPermissions(role, ['manageUsers']);\n};\n\n/**\n * Check if user is read-only\n * @param {string} role - User role\n * @returns {boolean} - True if user can only read\n */\nexport const isReadOnly = (role) => {\n  return role === 'user';\n};\n\n/**\n * Get all permissions for a role\n * @param {string} role - User role\n * @returns {object} - Object with permission flags\n */\nexport const getRolePermissions = (role) => {\n  return PERMISSIONS[role] || PERMISSIONS.user;\n};\n\n/**\n * Check if user can access a specific route\n * @param {string} role - User role\n * @param {string} route - Route path\n * @returns {boolean} - True if user can access route\n */\nexport const canAccessRoute = (role, route) => {\n  const protectedRoutes = {\n    '/items/create': ['create'],\n    '/items/edit': ['update'],\n    '/users': ['manageUsers'],\n  };\n\n  // Check if route requires specific permissions\n  for (const [routePattern, permissions] of Object.entries(protectedRoutes)) {\n    if (route.includes(routePattern)) {\n      return hasPermissions(role, permissions);\n    }\n  }\n\n  // Default routes accessible to all authenticated users\n  return true;\n};\n\n/**\n * Format role name for display\n * @param {string} role - User role\n * @returns {string} - Formatted role name\n */\nexport const formatRole = (role) => {\n  if (!role) return 'User';\n  \n  return role\n    .split('_')\n    .map(word => word.charAt(0).toUpperCase() + word.slice(1))\n    .join(' ');\n};\n\n/**\n * Get role badge class for styling\n * @param {string} role - User role\n * @returns {string} - CSS class name\n */\nexport const getRoleBadgeClass = (role) => {\n  switch (role) {\n    case 'super_admin':\n      return 'badge-danger';\n    case 'admin':\n      return 'badge-warning';\n    case 'user':\n      return 'badge-primary';\n    default:\n      return 'badge-secondary';\n  }\n};\n\n/**\n * Get available roles for role assignment\n * @param {string} currentUserRole - Current user's role\n * @returns {string[]} - Array of roles current user can assign\n */\nexport const getAssignableRoles = (currentUserRole) => {\n  switch (currentUserRole) {\n    case 'super_admin':\n      return ['user', 'admin', 'super_admin'];\n    case 'admin':\n      return ['user']; // Admins can only demote to user\n    default:\n      return []; // Regular users cannot assign roles\n  }\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}